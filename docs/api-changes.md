# Backward Incompatible API Changes

<a name="v2.0.0"></a>
## Version 2.0.0

### Integer Key Digest Incompatibility

The v1 client was computing the key digest for record keys with integer values
in a manner incompatible with all other Aerospike Client SDKs. Instead of
converting the integer values into binary format using big endian byte order
before computing the digest the Ruby v1 client was using little endian byte
order. Therefore the resulting hash values were different and as a result, a
database record with an integer key written using the Ruby v1 client could not
be retrieved by any other Aerospike client and vice versa.

The Ruby v2 client fixes this. However that means that the digests for integer
keys created with the v1 client and the v2 client necessarily differ. Database
records with integer keys written by the v1 client cannot be retrieved using
the v2 client in its default configuration.

The Ruby v2 client has a setting to restore backward compatibility with the
Ruby v1 client. (At the cost of continued incompatibiliy with all other
Aerospike clients libraries.) There are two options to enable v1 compatible
digest computation.

To enable v1 compatibility globally for all integer keys generated by the v2
client use the `Aerospike::Key.enable_v1_compatibility!` class method:

    k1 = Aerospike::Key.new('test', 'demo', 42)
    puts k1.digest.unpack("H*")                   # => cf5a1365effa4dc53333f2166d103358f8711096
    Aerospike::Key.enable_v1_compatibility!
    k2 = Aerospike::Key.new('test', 'demo', 42)
    puts k2.digest.unpack("H*")                   # => 0de7a87b3db745e84c7571d947c4b038bb735760

To create only specific keys using v1 compatible digest, set the
`v1_compatible` flag to true when initializing a new key instance:

    k1 = Aerospike::Key.new('test', 'demo', 42)
    puts k1.digest.unpack("H*")                   # => cf5a1365effa4dc53333f2166d103358f8711096
    k2 = Aerospike::Key.new('test', 'demo', 42, v1_compatible: true)
    puts k2.digest.unpack("H*")                   # => 0de7a87b3db745e84c7571d947c4b038bb735760

### Supported Ruby versions

Ruby 1.9.3 is no longer supported. Ruby 2.0 or later are requried to use
Aerospike Ruby client v2.0.
